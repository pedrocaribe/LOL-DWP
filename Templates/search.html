{% extends "layout.html" %} 
{% block title %} DWP v1.1 - Search Result {% endblock %}
{% block main %}


<div class="result_header" id="result_header" style="display: none;">
    <h1 id="feedback"></h1>

    <div class="outter-outter-div" id="outter-outter-div">
        
    </div>
</div>
<div class="loader" id="loader">
    <span class="binary"></span>
    <span class="binary"></span>
    <span class="getting-there">LOADING MATCHES DATA...</span>
</div>



<script>
    window.onload = function() {
        const form_data = JSON.parse('{{ form_data | tojson }}'); // Convert Flask dict to JS object

        fetch('/fetch-data', {
            method:'POST', 
            headers: {
            'Content-Type': 'application/json' 
            }, 
            body: JSON.stringify(form_data)
        })  // Replace with your actual Flask route
        .then(response => response.json())
        .then( data => {
                hideLoadingIndicator();
                const matchesContainer = document.querySelector('.outter-outter-div');

                data.forEach(match => {

                    const matchElement = document.createElement("div")
                    win_lose_p1 = `${match.win_lose_p1 ? 'win' : 'lose'}`
                    win_lose_p2 = `${match.win_lose_p2 ? 'win' : 'lose'}`
                    matchElement.classList.add("outter-div", "close")
                    matchElement.innerHTML = `    
                    <div class="row">
                        <div class="col flex-column0 ${win_lose_p1}">
                        </div>
                        <div class="col flex-column1">
                            <div class="match-container-left ">
                                <h5 class=${win_lose_p1}>${match.game_mode}</h5>
                                <p>${match.creation_time_ago}</p>
                                <div class="match-win-lose-duration">
                                    <dt class="mwld-dt">
                                        <span class=${win_lose_p1}>
                                            ${win_lose_p1 ? 'Win' : 'Lose'}
                                        </span>
                                    </dt>
                                    <span>
                                        ${match.duration}
                                    </span>
                                </div>
                                <div class"match-current-rank">

                                </div>
                            </div>
                        </div>
                        <div class="col flex-column2 ${win_lose_p1}">
                            <div class="summ-container">
                                <div class="summ-img-spells">
                                    <dl>
                                        <dt>
                                            <div class="summ-img-container">
                                                <div class="summ-img-ext">
                                                    <div class="summ-img-int">
                                                        <div class="summ-img-lane">
                                                            <div class="summ-img">
                                                                <img class="summ-img-img" src=${match.champ_p1_img} alt=''>
                                                            </div>
                                                            <div class="lane-img">
                                                                <div>
                                                                    <img src="">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>    
                                        </dt>
                                    </dl>
                                    <div class="kda">
                                    </div>
                                </div>
                                <div class="items">
                                    <div class="items-container">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col flex-column6 ${win_lose_p2}">
                            <div class="summ-container">
                                <div class="summ-img-spells">
                                    <dl>
                                        <dt>
                                            <div class="summ-img-container">
                                                <div class="summ-img-ext">
                                                    <div class="summ-img-int">
                                                        <div class="summ-img-lane">
                                                            <div class="summ-img">
                                                                <img class="summ-img-img" src=${match.champ_p2_img} alt=''>
                                                            </div>
                                                            <div class="lane-img">
                                                                <div>
                                                                    <img src="">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>    
                                        </dt>
                                    </dl>
                                    <div class="kda">
                                    </div>
                                </div>
                                <div class="items">
                                    <div class="items-container">
                                            
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col flex-column5">
                            
                        </div>
                        <div class="col flex-column7">
                            asd4
                        </div>
                        
                    </div>
        
                `;
                matchesContainer.appendChild(matchElement);
                })
                
                }
            )
        ;}

        function hideLoadingIndicator() {
        document.getElementById('loader').style.display = 'none';
        document.getElementById('result_header').style.display = 'block';
    }
</script>
<script src="./static/search_script.js" defer></script>
{% endblock %}
